package sample;


import javafx.scene.control.*;

import javafx.stage.FileChooser;


import java.io.*;

public class Controller {

    public TextArea binaryHeader;
    public TextArea traceHeader;
    public TextArea EXTtrace;
    public Spinner<Integer> tracespinner;
    public Spinner<Integer> samplespinner;
    public TextArea textHeader;
    public TextArea traceSample;

<<<<<<< HEAD
    String path_exe = "/home/ankush/Documents/Project/Seismic File X-ray/bin/ReadHeaders";
    String path_TextHeader = "/home/ankush/Documents/Project/Seismic File X-ray/output/TextHeader.txt";
    String path_BinaryHeader = "/home/ankush/Documents/Project/Seismic File X-ray/output/BinaryHeader.txt";
    String path_ExtendedTextHeader = "/home/ankush/Documents/Project/Seismic File X-ray/output/ExtendedTextHeader.txt";
    String path_TraceHeader = "/home/ankush/Documents/Project/Seismic File X-ray/output/TraceHeader.csv";
    String path_TraceData = "/home/ankush/Documents/Project/Seismic File X-ray/output/TraceData.csv";
    String path_TraceTitle = "/home/ankush/Documents/Project/Seismic File X-ray/output/TraceTitle.txt";
    String path_exe2 = "/home/ankush/Documents/Project/Seismic File X-ray/bin/ReadData";
    String path_Segy = "/home/ankush/Documents/Project/Seismic File X-ray/Dump/PSTM_STACK_439_UTM.sgy";
=======
    //Add paths to required files
    String path_exe = "";
    String path_TextHeader = "";
    String path_BinaryHeader = "";
    String path_ExtendedTextHeader = "";
    String path_TraceHeader = "";
    String path_TraceData = "";
    String path_TraceTitle = "";
    String path_exe2 = "";
    String path_Segy = "";
    
>>>>>>> 29b011784624e4a767fcacf4a52251c4dd8cf72e
    public void onDisplay() throws IOException {

        traceHeader.clear();
        traceSample.clear();
        String a = tracespinner.getEditor().getText();
        String b = samplespinner.getEditor().getText();
        System.out.println(a);
        FileReader data = new FileReader(path_TraceData);
        FileReader header = new FileReader(path_TraceHeader);
        FileReader title = new FileReader(path_TraceTitle);
        BufferedReader datardr = new BufferedReader(data);
        BufferedReader  titlerdr= new BufferedReader(title);
        LineNumberReader headerrdr = new LineNumberReader(header);



        if (new File(path_exe2).exists())

        {
            try {
                ProcessBuilder pb = new ProcessBuilder(path_exe2, path_Segy, a, b);
                pb.redirectError();
                Process p = pb.start();
                InputStream is = p.getInputStream();
                int value = -1;
                while ((value = is.read()) != -1) {
                    System.out.print((char) value);
                }
                int exitCode = p.waitFor();
                System.out.println(path_exe2 + " EXITED WITH " + exitCode);
            } catch (IOException e) {
                e.printStackTrace();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        } else
            System.out.println(path_exe2 + " Doesn't Exists");


        traceSample.setStyle("-fx-font-family: monospace");
        traceSample.appendText(datardr.readLine().replaceAll(",", "\n"));

        int l = Integer.parseInt(tracespinner.getEditor().getText());


        String line, line2;
        while (headerrdr.readLine() != null) {
            if (headerrdr.getLineNumber() == l) {

                line = headerrdr.readLine().replaceAll(",", "\n");
                String[] ary = line.split("\n");

                traceHeader.setStyle("-fx-font-family: monospace");
                int i = 0;
                while ((line2 = titlerdr.readLine()) != null) {
                        traceHeader.appendText(line2 + ary[i] + "\n");
                        i++;
                }

            }
        }
    }



    public String opener() {

        FileChooser fc = new FileChooser();
        File selectFile = fc.showOpenDialog(null);
        String path = null;
        if (selectFile != null) {
            path = selectFile.getAbsolutePath();
            System.out.println(path);

        } else {
            System.out.println("File not valid");
        }
        return path;
    }

    public void execute() {
        if (new File(path_exe).exists())

        {
            try {
                ProcessBuilder pb = new ProcessBuilder(path_exe, opener(), path_TextHeader, path_BinaryHeader, path_ExtendedTextHeader, path_TraceHeader);
                pb.redirectError();
                Process p = pb.start();
                InputStream is = p.getInputStream();
                int value = -1;
                while ((value = is.read()) != -1) {
                    System.out.print((char) value);
                }
                int exitCode = p.waitFor();
                System.out.println(path_exe + " EXITED WITH " + exitCode);
            } catch (IOException e) {
                e.printStackTrace();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        } else
            System.out.println(path_exe + " Doesn't Exists");

    }

    public void newFile() {
        File reader = new File(path_TextHeader);
        reader.delete();
        reader = new File(path_BinaryHeader);
        reader.delete();
        reader = new File(path_ExtendedTextHeader);
        reader.delete();
        reader = new File(path_TraceHeader);
        reader.delete();
        textHeader.clear();
        traceHeader.clear();
        binaryHeader.clear();
        EXTtrace.clear();

        execute();
    }

    public void readfile(){
        BufferedReader br;

        try {
            FileReader reader = new FileReader(path_TextHeader);
            br = new BufferedReader(reader);
            String line, newLine = "\n";
            int grabber;

            textHeader.setStyle("-fx-font-family: monospace");
            while ((line = br.readLine()) != null) {

                textHeader.appendText(line);
                textHeader.appendText("\n");
            }
            reader = new FileReader(path_BinaryHeader);
            br = new BufferedReader(reader);

            binaryHeader.setStyle("-fx-font-family: monospace");
            while ((line = br.readLine()) != null) {

                binaryHeader.appendText(line+"\n");

            }

        }

        catch (IOException e) {
            e.printStackTrace();
        }

    }
}



